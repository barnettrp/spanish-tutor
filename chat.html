<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, interactive-widget=resizes-visual">
  <title>Chat â€” Spanish Tutor (Party Mode)</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">

  <style>
    :root{
      --head-h:56px;                 /* measured in JS */
      --comp-h:64px;                 /* measured in JS */
      --safe-left: env(safe-area-inset-left);
      --safe-right: env(safe-area-inset-right);
      --safe-bottom: env(safe-area-inset-bottom);
    }

    /* 1) Freeze the page itself (no parent scroll/rubber-band) */
    html, body{
      position: fixed; inset: 0; margin: 0; width: 100%; height: 100%;
      overflow: hidden; overscroll-behavior: none; -webkit-overflow-scrolling: auto;
      touch-action: none;
      background:#0b0b0c; color:#fff; font-family: Nunito, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      padding-left: var(--safe-left); padding-right: var(--safe-right);
    }

    /* 2) Fixed rails */
    header.app__header{
      position: fixed; inset: 0 0 auto 0; height: var(--head-h);
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 16px; background:#0b0b0c; border-bottom:1px solid #2a2a2a; z-index:50;
    }
    header .left{ display:flex; align-items:center; gap:10px; }
    header .pill{ text-decoration:none; padding:6px 10px; border:1px solid #3a3a3a; border-radius:999px; font-size:.9rem; color:#fff; background:#151517; }
    .status{ margin-left:8px; opacity:.7; font-size:.9rem; }

    /* 3) Composer fixed to bottom */
    #composer{
      position: fixed; inset: auto 0 calc(var(--safe-bottom)) 0; min-height: var(--comp-h);
      display:flex; gap:8px; padding:12px; background:#0f0f12; border-top:1px solid #2a2a2a; z-index:50;
    }
    #composer input[type="text"]{
      flex:1 1 auto; min-width:0; padding:10px 12px; border-radius:10px; border:1px solid #3a3a3a;
      background:#151517; color:#fff; font-size:16px; /* avoid iOS zoom */
    }
    #composer .btn{ padding:10px 14px; border-radius:10px; border:1px solid #3a3a3a; background:#3b82f6; color:#fff; cursor:pointer; font:inherit; }
    #composer .pill{ border-color:#3a3a3a; background:#151517; color:#fff; font-size:.9rem; padding:6px 10px; }

    /* 4) The ONLY scrollable area (no intermediate wrappers) */
    #chatScroll{
      position: fixed; left: 0; right: 0;
      top: var(--head-h); bottom: var(--comp-h);
      overflow-y: auto; -webkit-overflow-scrolling: touch;
      overscroll-behavior-y: contain; touch-action: pan-y;  /* allow vertical pan here only */
      padding: 16px; background:#0e0e11; z-index: 1;
      word-break: break-word; overflow-wrap: anywhere;
    }

    /* Optional inner shell for your card look */
    .chat-shell{
      max-width: 960px; margin: 0 auto; min-height: 100%;
      border: 1px solid #2a2a2a; border-radius: 12px; overflow: clip;
      background:#0f0f12; display:flex; flex-direction:column;
    }
